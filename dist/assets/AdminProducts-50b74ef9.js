import{_,o as i,c as r,a as t,d as m,t as u,r as p,F as f,e as v,b as h}from"./index-92e8dc37.js";import{A as x}from"./AlertModal-09136cc6.js";import{M,U as y}from"./UserProductModal-65551277.js";const k={props:["pages","pagination","getProductData"],methods:{updatePage(o){this.$emit("emitPages",o)}}},w={class:"lo"};function C(o,e,s,l,a,d){return i(),r("div",w,"123")}const D=_(k,[["render",C]]),A={props:["tempProduct"],data(){return{modal:null}},mounted(){this.modal=new M(this.$refs.delProductModal,{keyboard:!1})},methods:{delProduct(){this.$emit("del-product",this.tempProduct)}}},U={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},N={class:"modal-dialog"},S={class:"modal-content border-0"},V={class:"modal-header bg-danger text-white"},B=t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")],-1),E={class:"modal-body"},L={class:"text-danger"},F={class:"modal-footer"};function T(o,e,s,l,a,d){return i(),r("div",U,[t("div",N,[t("div",S,[t("div",V,[B,t("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=c=>a.modal.hide()),"aria-label":"Close"})]),t("div",E,[m(" 是否刪除 "),t("strong",L,u(s.tempProduct.title),1),m(" 商品(刪除後將無法恢復)。 ")]),t("div",F,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[1]||(e[1]=c=>a.modal.hide())}," 取消 "),t("button",{type:"button",class:"btn btn-danger",onClick:e[2]||(e[2]=(...c)=>d.delProduct&&d.delProduct(...c))}," 確認刪除 ")])])])],512)}const j=_(A,[["render",T]]),q={data(){return{pagination:[],products:[],tempProduct:{imagesUrl:[]},successAlert:!1,toastMsg:"新增完成",modalVisable:!0}},components:{Pagination:D,UserProductModal:y,AlertModal:x,DeleteProductModel:j},methods:{alertShow(){this.successAlert=!0,setTimeout(()=>{this.successAlert=!1},3e3)},updateProduct(){this.toastMsg="產品新增成功";let o=`${this.apiUrl}/api/${this.apiPath}/admin/product`,e="post";this.isNew||(o=`${this.apiUrl}/api/${this.apiPath}/admin/product/${this.tempProduct.id}`,e="put",this.toastMsg="產品更新成功"),console.log(this.tempProduct),this.axios[e](o,{data:this.tempProduct}).then(s=>{console.log(s),this.alertShow(),this.getProductData()}).catch(s=>{alert(s.response.data.message)})},delProduct(){this.toastMsg="產品刪除成功";const o=`https://vue3-course-api.hexschool.io/v2//api/lobinda/admin/product/${this.tempProduct.id}`;this.axios.delete(o).then(()=>{this.alertShow(),this.$refs.deleteProduct.modal.hide(),this.getProductData()}).catch(e=>{alert(e.response.data.message)})},getProductData(o,e){const s=`https://vue3-course-api.hexschool.io/v2/api/lobinda/admin/products?page=${o}`;this.axios.get(s,{params:{page:o,category:e}}).then(l=>{this.products=l.data.products,this.pagination=l.data.pagination}).catch(l=>{alert(l.response.data.message)})},getProducts(o=1){const e=`https://vue3-course-api.hexschool.io/v2/api/lobinda/admin/products?page=${o}`;this.$http.get(e).then(s=>{this.products=s.data.products,this.pagination=s.data.pagination}).catch(s=>{alert(s.response.data.message)})},openModal(o,e){this.isNew=!1,o==="new"?(this.tempProduct={imagesUrl:[]},this.tempProduct={},this.isNew=!0):o==="edit"?this.tempProduct={...e}:o==="delete"&&(this.tempProduct={...e},this.$refs.deleteProduct.modal.show())}},mounted(){this.getProducts()}},z={class:"text-end mt-4"},G={class:"table mt-4 table-hover"},H=t("thead",null,[t("tr",{class:"table-dark"},[t("th",{width:"120"}," 分類 "),t("th",null,"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),I={class:"text-end"},J={class:"text-end"},K={key:0,class:"text-success"},O={key:1},Q={class:"btn-group"},R=["onClick"],W=["onClick"];function X(o,e,s,l,a,d){const c=p("user-product-modal"),g=p("pagination"),P=p("alert-modal"),b=p("delete-product-model");return i(),r("div",null,[m(" 這裡是 後台 產品管理 "),t("div",z,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=n=>d.openModal("new"))}," 建立新的產品 ")]),t("table",G,[H,t("tbody",null,[(i(!0),r(f,null,v(a.products,n=>(i(),r("tr",{key:n.id},[t("td",null,u(n.category),1),t("td",null,u(n.title),1),t("td",I,u(n.origin_price),1),t("td",J,u(n.price),1),t("td",null,[n.is_enabled?(i(),r("span",K,"啟用")):(i(),r("span",O,"未啟用"))]),t("td",null,[t("div",Q,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:$=>d.openModal("edit",n)}," 編輯 ",8,R),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:$=>d.openModal("delete",n)}," 刪除 ",8,W)])])]))),128))])]),h(c),h(g,{pagination:a.pagination,pages:a.pagination,"get-product-data":d.getProductData,onEmitPages:d.getProducts},null,8,["pagination","pages","get-product-data","onEmitPages"]),h(P,{"success-alert":a.successAlert,"toast-msg":a.toastMsg},null,8,["success-alert","toast-msg"]),h(b,{ref:"deleteProduct","temp-product":a.tempProduct,onDelProduct:d.delProduct},null,8,["temp-product","onDelProduct"])])}const et=_(q,[["render",X]]);export{et as default};
