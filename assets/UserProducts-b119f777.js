import{U as v}from"./UserProductModal-b49eea59.js";import{A as k}from"./AlertModal-2ef21161.js";import{_ as y,r as c,o as d,c as n,b as u,a as s,F as M,e as C,n as S,t as i,f as l,d as g}from"./index-7c27bc6f.js";const P={data(){return{toastMsg:"",successAlert:!1,products:[],loadingStatus:{loadingItem:""},isLoading:!1,product:{}}},components:{UserProductModal:v,AlertModal:k},mounted(){this.getProducts()},methods:{alertShow(){this.successAlert=!0,setTimeout(()=>{this.successAlert=!1},1e3)},addToCart(o,a=1){this.toastMsg="";const r="https://vue3-course-api.hexschool.io/v2//api/lobinda/cart",h={product_id:o,qty:a};this.axios.post(r,{data:h}).then(e=>{this.toastMsg=e.data.message,this.alertShow(),this.$refs.userProductModal.hideModal()}).catch(e=>{alert(e.response.data.message)})},getProducts(){this.isLoading=!0;const o="https://vue3-course-api.hexschool.io/v2/api/lobinda/products";this.$http.get(o).then(a=>{this.products=a.data.products,this.isLoading=!1}).catch(a=>{alert(a.response.data.message)})},getProduct(o){this.isLoading=!0;const a=`https://vue3-course-api.hexschool.io/v2/api/lobinda/product/${o}`;this.loadingStatus.loadingItem=o,this.$http.get(a).then(r=>{this.loadingStatus.loadingItem="",this.product=r.data.product,this.isLoading=!1,this.$refs.userProductModal.openModal()}).catch(r=>{alert(r.response.data.message)})}}},x=s("h1",null,"This is 產品列表頁面",-1),L={class:"table align-middle table-hover"},$=s("thead",null,[s("tr",null,[s("th",null,"圖片"),s("th",null,"商品名稱"),s("th",null,"價格"),s("th")])],-1),A={style:{width:"200px"}},I={key:0,class:"h5"},T={key:1,class:"h6"},U={key:2,class:"h5"},V={class:"btn-group btn-group-sm"},N=["onClick","disabled"],w={key:0,class:"fas fa-spinner fa-pulse"},B=["onClick","disabled"],z={key:0,class:"fas fa-spinner fa-pulse"};function F(o,a,r,h,e,p){const _=c("VueLoading"),b=c("alert-modal"),f=c("UserProductModal");return d(),n("div",null,[x,u(_,{active:e.isLoading},null,8,["active"]),u(b,{"success-alert":e.successAlert,"toast-msg":e.toastMsg},null,8,["success-alert","toast-msg"]),s("table",L,[$,s("tbody",null,[(d(!0),n(M,null,C(e.products,t=>(d(),n("tr",{key:t.id},[s("td",A,[s("div",{style:S([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),s("td",null,i(t.title),1),s("td",null,[t.price?l("",!0):(d(),n("div",I,i(t.origin_price)+" 元",1)),t.price?(d(),n("del",T,"原價 "+i(t.origin_price)+" 元",1)):l("",!0),t.price?(d(),n("div",U,"限時特價只要 "+i(t.price)+" 元",1)):l("",!0)]),s("td",null,[s("div",V,[s("button",{type:"button",class:"btn btn-outline-secondary",onClick:m=>o.$router.push(`/product/${t.id}`),disabled:e.loadingStatus.loadingItem===t.id||!t.is_enabled},[e.loadingStatus.loadingItem===t.id?(d(),n("i",w)):l("",!0),g(" 查看更多 ")],8,N),s("button",{type:"button",class:"btn btn-outline-danger",onClick:m=>p.addToCart(t.id),disabled:e.loadingStatus.loadingItem===t.id||!t.is_enabled},[e.loadingStatus.loadingItem===t.id?(d(),n("i",z)):l("",!0),g(" 加到購物車 ")],8,B)])])]))),128))])]),u(f,{ref:"userProductModal",product:e.product,onAddToCart:p.addToCart},null,8,["product","onAddToCart"])])}const q=y(P,[["render",F]]);export{q as default};
